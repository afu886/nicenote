/**
 * constants.ts — 业务常量
 *
 * 放在这里的东西的标准:
 *   ✅ 多个 app 都需要用到
 *   ✅ 跟设计规范无关（设计规范放 tokens）
 *   ❌ 只有某个 app 用到的配置 → 放到那个 app 自己的 config 里
 *   ❌ 环境相关的值（如 API URL）→ 用环境变量，这里只放默认值
 */

// ============================================================
// API 相关
// ============================================================

/** API 默认超时，毫秒 */
export const API_TIMEOUT = 30_000

/** API 重试次数 */
export const API_RETRIES = 3

/** API 重试间隔基础值，毫秒（实际使用指数退避） */
export const API_RETRY_DELAY = 1000

// ============================================================
// 分页
// ============================================================

/** 默认每页条数 */
export const PAGE_SIZE_DEFAULT = 20

/** 每页条数可选值 */
export const PAGE_SIZE_OPTIONS = [10, 20, 50, 100] as const

/** 每页条数上限 */
export const PAGE_SIZE_MAX = 100

// ============================================================
// 存储 key 前缀
// 统一前缀规范，避免不同模块的 key 冲突
// ============================================================

export const STORAGE_KEYS = {
  AUTH_TOKEN: 'auth:token',
  AUTH_REFRESH_TOKEN: 'auth:refreshToken',
  AUTH_USER: 'auth:user',
  SETTINGS: 'settings:preferences',
  THEME: 'settings:theme',
} as const

// ============================================================
// Token / 认证
// ============================================================

/** token 刷新前的预警时间，毫秒（token 过期前多久开始刷新） */
export const TOKEN_REFRESH_THRESHOLD = 5 * 60 * 1000 // 5 分钟

// ============================================================
// 缓存 TTL（毫秒）
// ============================================================

export const CACHE_TTL = {
  SHORT: 1 * 60 * 1000, // 1 分钟
  MEDIUM: 5 * 60 * 1000, // 5 分钟
  LONG: 60 * 60 * 1000, // 1 小时
  DAY: 24 * 60 * 60 * 1000, // 1 天
} as const

// ============================================================
// 输入限制
// ============================================================

export const INPUT_LIMITS = {
  /** 密码最小长度 */
  PASSWORD_MIN_LENGTH: 8,
  /** 密码最大长度 */
  PASSWORD_MAX_LENGTH: 64,
  /** 用户名最小长度 */
  USERNAME_MIN_LENGTH: 2,
  /** 用户名最大长度 */
  USERNAME_MAX_LENGTH: 32,
  /** 普通文本最大长度 */
  TEXT_MAX_LENGTH: 500,
  /** 长文本最大长度 */
  LONG_TEXT_MAX_LENGTH: 10000,
  /** 文件上传大小上限，字节（默认 10MB） */
  FILE_UPLOAD_MAX_SIZE: 10 * 1024 * 1024,
} as const

// ============================================================
// 正则（通用的放这里，业务专属的放 validators）
// ============================================================

export const REGEX = {
  EMAIL:
    /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,
  PHONE_CN: /^1[3-9]\d{9}$/,
  URL: /^https?:\/\/(?:[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b)?(?:[-a-zA-Z0-9()@:%_+.~#?&/=]*)$/,
  UUID: /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,
} as const

// ============================================================
// HTTP 状态码映射
// ============================================================

export const HTTP_STATUS_MESSAGES: Record<number, string> = {
  200: '成功',
  201: '创建成功',
  204: '无内容',
  400: '请求错误',
  401: '未认证，请登录',
  403: '权限不足',
  404: '资源未找到',
  409: '冲突',
  422: '参数校验失败',
  429: '请求太频繁，请稍后重试',
  500: '服务器内部错误',
  502: '网关错误',
  503: '服务不可用',
} as const
